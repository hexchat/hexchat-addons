#	hexchat-homoglyph.pl
#	Converts text into visually similar yet different characters.
#	Author: William Woodruff
#	------------------------
#	This code is licensed by William Woodruff under the MIT License.
#	http://opensource.org/licenses/MIT

use strict;
use warnings;
use utf8;

use Xchat qw(:all);

my $PLUGIN_NAME = 'homoglyph';
my $PLUGIN_VERS = '1.0';
my $PLUGIN_DESC = 'converts characters into visually similar glyphs';

my %GLYPHS = (
	'!' => ['!', 'Çƒ', 'ï¼'],
	'"' => ['"', '×´', 'â€³', 'ï¼‚'],
	'$' => ['$', 'ï¼„'],
	'%' => ['%', 'ï¼…'],
	'&' => ['&', 'ï¼†'],
	'(' => ['(', 'ï¹', 'ï¼ˆ'],
	')' => [')', 'ï¹ž', 'ï¼‰'],
	'*' => ['*', 'âŽ', 'ï¼Š'],
	'+' => ['+', 'ï¼‹'],
	',' => [',', 'â€š', 'ï¼Œ'],
	'-' => ['-', 'â€', 'ï¿½ï¼'],
	'.' => ['.', 'Ù ', 'Û”', 'Ü', 'Ü‚', 'â€¤', 'â€§', 'ã€‚', 'ï¼Ž', 'ï½¡'],
	'/' => ['/', 'Ì¸', 'â„', 'âˆ•', 'â•±', 'â«»', 'â«½', 'ï¼', 'ï¾‰'],
	'0' => ['0', 'O', 'o', 'ÎŸ', 'Î¿', 'Ðž', 'Ð¾', 'Õ•', 'ï¼¯', 'ï½'],
	'1' => ['1', 'I', 'Ø§', 'ï¼‘'],
	'2' => ['2', 'ï¼’'],
	'3' => ['3', 'ï¼“'],
	'4' => ['4', 'ï¼”'],
	'5' => ['5', 'ï¼•'],
	'6' => ['6', 'ï¼–'],
	'7' => ['7', 'ï¼—'],
	'8' => ['8', 'Õ‘', 'ï¼˜'],
	'9' => ['9', 'ï¼™'],
	':' => [':', 'Ö‰', 'Üƒ', 'Ü„', 'âˆ¶', 'êž‰', 'ï¼š'],
	';' => [';', 'Í¾', 'ï¼›'],
	'<' => ['<', 'â€¹', 'ï¼œ'],
	'=' => ['=', 'ï¼'],
	'>' => ['>', 'â€º', 'ï¼ž'],
	'?' => ['?', 'ï¼Ÿ', 'Â¿'],
	'@' => ['@', 'ï¼ '],
	'[' => ['[', 'ï¼»'],
	'\\' => ['\\', 'ï¼¼'],
	']' => [']', 'ï¼½'],
	'^' => ['^', 'ï¼¾'],
	'_' => ['_', 'ï¼¿'],
	'`' => ['`', 'ï½€'],
	'a' => ['A', 'a', 'Ã€', 'Ã', 'Ã‚', 'Ãƒ', 'Ã„', 'Ã…', 'Ã ', 'Ã¡', 'Ã¢', 'Ã£', 'Ã¤', 'Ã¥', 'É‘', 'Î‘', 'Î±', 'Ð°', 'áŽª', 'ï¼¡', 'ï½'],
	'b' => ['B', 'b', 'ÃŸ', 'Ê™', 'Î’', 'Î²', 'Ð’', 'Ð¬', 'á´', 'á›’', 'ï¼¢', 'ï½‚'],
	'c' => ['C', 'c', 'Ï²', 'Ï¹', 'Ð¡', 'Ñ', 'áŸ', 'â…­', 'â…½', 'ï¼£', 'ï½ƒ'],
	'd' => ['D', 'd', 'ÄŽ', 'Ä', 'Ä', 'Ä‘', 'Ô', 'Õª', 'áŽ ', 'â…®', 'â…¾', 'ï¼¤', 'ï½„'],
	'e' => ['E', 'e', 'Ãˆ', 'Ã‰', 'ÃŠ', 'Ã‹', 'Ã©', 'Ãª', 'Ã«', 'Ä’', 'Ä“', 'Ä”', 'Ä•', 'Ä–', 'Ä—', 'Ä˜', 'Äš', 'Ä›', 'Î•', 'Ð•', 'Ðµ', 'áŽ¬', 'ï¼¥', 'ï½…'],
	'f' => ['F', 'f', 'Ïœ', 'ï¼¦', 'ï½†'],
	'g' => ['G', 'g', 'É¡', 'É¢', 'ÔŒ', 'Õ¶', 'á€', 'ï¼§', 'ï½‡'],
	'h' => ['H', 'h', 'Êœ', 'Î—', 'Ð', 'Ò»', 'áŽ»', 'ï¼¨', 'ï½ˆ'],
	'i' => ['I', 'i', 'l', 'É©', 'Î™', 'Ð†', 'Ñ–', 'Ø§', 'áŽ¥', 'á›', 'â… ', 'â…°', 'ï¼©', 'ï½‰'],
	'j' => ['J', 'j', 'Ï³', 'Ðˆ', 'Ñ˜', 'Õµ', 'áŽ«', 'ï¼ª', 'ï½Š'],
	'k' => ['K', 'k', 'Îš', 'Îº', 'Ðš', 'á¦', 'á›•', 'â„ª', 'ï¼«', 'ï½‹'],
	'l' => ['L', 'l', 'ÊŸ', 'Î¹', 'Ø§', 'áž', 'â…¬', 'â…¼', 'ï¼¬', 'ï½Œ'],
	'm' => ['M', 'm', 'Îœ', 'Ïº', 'Ðœ', 'áŽ·', 'á›–', 'â…¯', 'â…¿', 'ï¼­', 'ï½'],
	'n' => ['N', 'n', 'É´', 'Î', 'ï¼®', 'ï½Ž'],
	'o' => ['0', 'O', 'o', 'ÎŸ', 'Î¿', 'Ðž', 'Ð¾', 'Õ•', 'ï¼¯', 'ï½'],
	'p' => ['P', 'p', 'Î¡', 'Ï', 'Ð ', 'Ñ€', 'á¢', 'ï¼°', 'ï½'],
	'q' => ['Q', 'q', 'á‚­', 'á‚³', 'ï¼±', 'ï½‘'],
	'r' => ['R', 'r', 'Ê€', 'Ô»', 'á’', 'áš±', 'ï¼²', 'ï½’'],
	's' => ['S', 's', 'Ð…', 'Ñ•', 'Õ', 'á‚½', 'áš', 'ð ', 'ï¼³', 'ï½“'],
	't' => ['T', 't', 'Î¤', 'Ï„', 'Ð¢', 'áŽ¢', 'ï¼´', 'ï½”'],
	'u' => ['U', 'u', 'Î¼', 'Ï…', 'Ô±', 'Õ', 'â‹ƒ', 'ï¼µ', 'ï½•'],
	'v' => ['V', 'v', 'Î½', 'Ñ´', 'Ñµ', 'á™', 'â…¤', 'â…´', 'ï¼¶', 'ï½–'],
	'w' => ['W', 'w', 'Ñ¡', 'áŽ³', 'ï¼·', 'ï½—'],
	'x' => ['X', 'x', 'Î§', 'Ï‡', 'Ð¥', 'Ñ…', 'â…©', 'â…¹', 'ï¼¸', 'ï½˜'],
	'y' => ['Y', 'y', 'Ê', 'Î¥', 'Î³', 'Ñƒ', 'Ò®', 'ï¼¹', 'ï½™'],
	'z' => ['Z', 'z', 'Î–', 'áƒ', 'ï¼º', 'ï½š'],
	'{' => ['{', 'ï½›'],
	'|' => ['|', 'Ç€', 'Ø§', 'ï½œ'],
	'}' => ['}', 'ï½'],
	'~' => ['~', 'â“', 'ï½ž']
);

register($PLUGIN_NAME, $PLUGIN_VERS, $PLUGIN_DESC, \&on_unload);
Xchat::printf("Loaded %s version %s", $PLUGIN_NAME, $PLUGIN_VERS);

sub on_unload {
	Xchat::printf("%s version %s unloaded.", $PLUGIN_NAME, $PLUGIN_VERS);
}

hook_command('hg', \&homoglyphify, {help_text => "Usage: /hg <text> to homoglyphify the given text."});

sub homoglyphify {
	my $text = lc($_[1][1]);
	my $result = '';

	foreach (split //, $text) {
		if (exists $GLYPHS{$_}) {
			my @glyphs = @{$GLYPHS{$_}};
			$result .= $glyphs[rand @glyphs];
		}
		else {
			$result .= $_;
		}
	}

	command("say $result");

	return EAT_ALL;
}
